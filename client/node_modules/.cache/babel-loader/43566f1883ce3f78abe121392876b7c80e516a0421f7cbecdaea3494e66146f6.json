{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function NegotiateModal(_ref){let{show,onClose,order,onNegotiated,role}=_ref;const[price,setPrice]=useState((order===null||order===void 0?void 0:order.negotiated_price)||(order===null||order===void 0?void 0:order.price)||'');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');if(!show||!order)return null;const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');setSuccess('');try{const token=localStorage.getItem('token');const endpoint=role==='buyer'?\"http://localhost:5000/api/orders/buyer-negotiate/\".concat(order.id):\"http://localhost:5000/api/orders/negotiate/\".concat(order.id);const res=await fetch(endpoint,{method:'PATCH',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)},body:JSON.stringify({negotiated_price:price})});const data=await res.json();if(!data.success){setError(data.message||'Negotiation failed');}else{setSuccess('Negotiated price sent!');if(onNegotiated)onNegotiated();}}catch(err){setError('Network error');}setLoading(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"modal show d-block\",tabIndex:\"-1\",role:\"dialog\",style:{background:'rgba(0,0,0,0.4)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",children:role==='buyer'?'Counter Offer':'Negotiate Price'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:onClose})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[\"Product: \",/*#__PURE__*/_jsx(\"b\",{children:order.product_name})]}),role==='farmer'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[\"Buyer: \",order.buyer_name,\" (\",order.buyer_email,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Negotiated Price (\\u20B9)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",min:1,value:price,onChange:e=>setPrice(e.target.value),required:true})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success\",children:success})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:onClose,children:\"Close\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-warning\",disabled:loading,children:loading?'Sending...':role==='buyer'?'Send Counter Offer':'Send Negotiation'})]})]})]})})});}export default NegotiateModal;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","NegotiateModal","_ref","show","onClose","order","onNegotiated","role","price","setPrice","negotiated_price","loading","setLoading","error","setError","success","setSuccess","handleSubmit","e","preventDefault","token","localStorage","getItem","endpoint","concat","id","res","fetch","method","headers","Authorization","body","JSON","stringify","data","json","message","err","className","tabIndex","style","background","children","type","onClick","onSubmit","product_name","buyer_name","buyer_email","min","value","onChange","target","required","disabled"],"sources":["C:/Users/Devi Sri Prasad/Desktop/Farmaconnect/client/src/NegotiateModal.js"],"sourcesContent":["import React, { useState } from 'react';\n\nfunction NegotiateModal({ show, onClose, order, onNegotiated, role }) {\n  const [price, setPrice] = useState(order?.negotiated_price || order?.price || '');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n\n  if (!show || !order) return null;\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    setSuccess('');\n    try {\n      const token = localStorage.getItem('token');\n      const endpoint = role === 'buyer'\n        ? `http://localhost:5000/api/orders/buyer-negotiate/${order.id}`\n        : `http://localhost:5000/api/orders/negotiate/${order.id}`;\n      const res = await fetch(endpoint, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({ negotiated_price: price })\n      });\n      const data = await res.json();\n      if (!data.success) {\n        setError(data.message || 'Negotiation failed');\n      } else {\n        setSuccess('Negotiated price sent!');\n        if (onNegotiated) onNegotiated();\n      }\n    } catch (err) {\n      setError('Network error');\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"modal show d-block\" tabIndex=\"-1\" role=\"dialog\" style={{ background: 'rgba(0,0,0,0.4)' }}>\n      <div className=\"modal-dialog\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <h5 className=\"modal-title\">{role === 'buyer' ? 'Counter Offer' : 'Negotiate Price'}</h5>\n            <button type=\"button\" className=\"btn-close\" onClick={onClose}></button>\n          </div>\n          <form onSubmit={handleSubmit}>\n            <div className=\"modal-body\">\n              <div className=\"mb-2\">Product: <b>{order.product_name}</b></div>\n              {role === 'farmer' && <div className=\"mb-2\">Buyer: {order.buyer_name} ({order.buyer_email})</div>}\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Negotiated Price (â‚¹)</label>\n                <input type=\"number\" className=\"form-control\" min={1} value={price} onChange={e => setPrice(e.target.value)} required />\n              </div>\n              {error && <div className=\"alert alert-danger\">{error}</div>}\n              {success && <div className=\"alert alert-success\">{success}</div>}\n            </div>\n            <div className=\"modal-footer\">\n              <button type=\"button\" className=\"btn btn-secondary\" onClick={onClose}>Close</button>\n              <button type=\"submit\" className=\"btn btn-warning\" disabled={loading}>{loading ? 'Sending...' : (role === 'buyer' ? 'Send Counter Offer' : 'Send Negotiation')}</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default NegotiateModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}